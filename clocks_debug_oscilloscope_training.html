<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ğŸ›  STM32 Clock Training Guide</title>  
  <link rel="stylesheet" href="styles.css" />
  <!-- <style>
    body {
      margin: 0;
      padding: 2em;
      font-family: 'Segoe UI', sans-serif;
      background-color: #1e1e1e;
      color: #ffffff;
    }
    .container {
      max-width: 960px;
      margin: auto;
    }
    h1, h2, h3 {
      color: #ffcc00;
    }
    pre, code {
      background: #2d2d2d;
      color: #00ff88;
      padding: 1em;
      border-radius: 10px;
      overflow-x: auto;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin: 1em 0;
    }
    th, td {
      border: 1px solid #555;
      padding: 0.5em;
      text-align: left;
    }
    th {
      background-color: #333;
    }
    .note {
      background: #333;
      border-left: 4px solid #ffcc00;
      padding: 1em;
      margin: 1em 0;
    }
  </style> -->
</head>
<body>
    <div class="overlay">

    <div class="header">
        <h1>ğŸ›  Step-by-Step Training: Clocks & Oscillators on STM32</h1>
    </div>
    <div class="section">

    <h2>ğŸ§ª Oscilloscope Integration in Clock Training</h2>

    <h3>ğŸ“ Tools Required</h3>
    <ul>
      <li>Oscilloscope (2-channel preferred)</li>
      <li>STM32 Board (with accessible GPIOs and external crystal)</li>
      <li>Probes for capturing signals</li>
      <li>Optional: UART USB bridge for verification logs</li>
    </ul>

    <h3>ğŸ”¹ Step-wise Oscilloscope Usage</h3>

    <h4>âœ… Step 1: Blink LED using Internal Clock (HSI)</h4>
    <p><strong>Connection:</strong> Probe CH1 â†’ LED GPIO (e.g., PC13)</p>
    <p><strong>Expected Waveform:</strong> 1Hz square wave (1s HIGH, 1s LOW)</p>
    <p><strong>Purpose:</strong> Confirm LED timing using HSI (~8 MHz)</p>
    <pre><code>HSI (8 MHz) ---> SysTick Timer ---> HAL_Delay(1000ms) ---> GPIO_Toggle</code></pre>
    <pre style="background:#1a1a1a; color:#00ffcc; padding:1em; border-left: 4px solid #ffaa00;">
Zoomed View:
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚  1s HIGH   â”‚ 
â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                    â†‘ 1s LOW
    </pre>

    <h4>âœ… Step 2: Blink LED using External Crystal (HSE)</h4>
    <p><strong>Connection:</strong> CH1 â†’ LED GPIO, CH2 â†’ XTAL pin</p>
    <p><strong>Expected:</strong> Same 1Hz LED blink, CH2 shows 8 MHz sine wave</p>
    <pre><code>[XTAL 8MHz] ---> MCU Clock ---> SysTick ---> LED Toggle</code></pre>

    <pre style="background:#1a1a1a; color:#00ffcc; padding:1em; border-left: 4px solid #33ccff;">
CH1 (LED Blink):
       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚  1s HIGH   â”‚ 
â”€â”€â”€â”€â”€â”€â”€â”˜            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
                    â†‘ 1s LOW

CH2 (XTAL Pin):
~\~/~\~/~\~/~\~/~\~/~\~/~\~/~\~/~ â† ~8 MHz (~125 ns)
    </pre>

    <h4>âœ… Step 3: PLL Enabled (HSE Ã— 9 = 72 MHz)</h4>
    <p><strong>Connection:</strong> CH1 â†’ LED, CH2 â†’ GPIO toggled in loop</p>
    <pre><code>while(1) {
  HAL_GPIO_WritePin(GPIOB, GPIO_PIN_0, GPIO_PIN_SET);
  HAL_GPIO_WritePin(GPIOB, GPIO_PIN_0, GPIO_PIN_RESET);
}</code></pre>
    <p><strong>Expected:</strong> High-frequency square wave to measure CPU speed</p>
    <pre><code>XTAL (8 MHz) â†’ PLL Ã— 9 â†’ 72 MHz â†’ SystemCoreClock</code></pre>
    <p><strong>Scope Reading:</strong> Frequency = toggle freq Ã— 2</p>
    <pre style="background:#1a1a1a; color:#00ffcc; padding:1em; border-left: 4px solid #44dd88;">
CH1 (Toggling GPIO):
   â”Œâ”€â” â”Œâ”€â” â”Œâ”€â” â”Œâ”€â” â”Œâ”€â” â”Œâ”€â” â”Œâ”€â”
â”€â”€â”€â”˜ â””â”€â”˜ â””â”€â”˜ â””â”€â”˜ â””â”€â”˜ â””â”€â”˜ â””â”€â”˜ â† Fast toggling (~6â€“14 ns per edge depending on code)

Zoom into a single cycle:
   â”Œâ”€â”€â”€â”€â”
   â”‚    â”‚ â† e.g., 13.8 ns HIGH
â”€â”€â”€â”˜    â””â”€â”€â”€â”€â” â† 13.8 ns LOW
            â”‚
    Total: ~27.6 ns = 36.2 MHz GPIO toggle freq
           â†’ SYSCLK = 36.2 Ã— 2 = ~72 MHz
    </pre>

    <p><strong>Measure toggle period and multiply by 2 to estimate SYSCLK</p>

    <h4>âœ… Step 4: Delay Accuracy Test with DWT/Timer</h4>
    <p><strong>Connection:</strong> CH1 â†’ GPIO used in delay_us</p>
    <pre><code>HAL_GPIO_WritePin(GPIOB, GPIO_PIN_1, GPIO_PIN_SET);
delay_us(100);
HAL_GPIO_WritePin(GPIOB, GPIO_PIN_1, GPIO_PIN_RESET);</code></pre>
    <p><strong>Expected:</strong> Pulse of 100 Âµs (verify via cursor tool)</p>    
    <pre style="background:#1a1a1a; color:#00ffcc; padding:1em; border-left: 4px solid #ffaa00;">
Zoomed: â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚        â”‚ â† 100 Âµs
â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€
    </pre>

    <h4>âœ… Step 5: Clock Failure Fallback Test</h4>
    <p><strong>Action:</strong> Disable HSE or simulate fault</p>
    <p><strong>Expected:</strong> LED halts briefly then resumes with different rate (HSI)</p>
    <p><strong>Debug Pin:</strong> Optional GPIO HIGH for HSE, LOW for HSI</p>
    <pre style="background:#1a1a1a; color:#00ffcc; padding:1em; border-left: 4px solid #ffaa00;">
            HSE ON                 CLOCK FAIL               HSI Fallback
CH1:  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”         (no toggling)          â”Œâ”€â” â”Œâ”€â” â”Œâ”€â” â”Œâ”€â” â”Œâ”€â”
      â”‚             â”‚                               â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚ â”‚
â”€â”€â”€â”€â”€â”€â”˜             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”˜ â””â”€â”˜ â””â”€â”˜ â””â”€â”˜
    </pre>

    <h4>âœ… Step 6: RTC with LSE</h4>
    <p><strong>Connection:</strong> CH1 â†’ GPIO toggled on 1s RTC callback, CH2 â†’ LSE pin</p>
    <p><strong>Expected:</strong> 1Hz square wave on CH1, 32.768 kHz sine wave on CH2</p>
    <pre style="background:#1a1a1a; color:#00ffcc; padding:1em; border-left: 4px solid #ffaa00;">
CH1 (1 Hz):
        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
        â”‚        â”‚       â”‚        â”‚
â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€

CH2 (32.768 kHz):
    ~\~/~\~/~\~/~\~/~\~/~\~/~\~/~\~/~\~/~ (~30.5 Âµs period)
    </pre>


    <h2>ğŸ“Š Clock Tree Diagram (Simplified STM32 Example)</h2>
    <pre>
      <pre style="background:#1a1a1a; color:#00ffcc; padding:1em; border-left: 4px solid #ffaa00;">
                +------------------+
                | HSI (8 MHz)      |
                +--------+---------+
                         |
              +----------v------------+
              |      Multiplexer      |<--- LSE / LSI (RTC)
              |  Select Clock Source  |
              +----------+------------+
                         |
                    +----v-----+
                    |   PLL    | <--- Optional (x2 to x16)
                    +----+-----+
                         |
                  +------v------+
                  | System Clock |
                  | (SYSCLK)     |
                  +------+-------+
                         |
     +----------------+------+------+---------------+
     |                |             |               |
+----v---+       +----v---+     +----v----+    +----v----+
| Core   |       | Timers |     | UART    |    | ADC/DAC  |
+--------+       +--------+     +---------+    +----------+
</pre>

    <h2>ğŸ¯ Learning Outcome for Freshers</h2>
    <table>
      <thead>
        <tr><th>Skill</th><th>Verified by Scope</th></tr>
      </thead>
      <tbody>
        <tr><td>Clock source switching</td><td>âœ…</td></tr>
        <tr><td>Delay accuracy vs frequency</td><td>âœ…</td></tr>
        <tr><td>PLL frequency multiplication</td><td>âœ…</td></tr>
        <tr><td>Oscillator waveform shape</td><td>âœ…</td></tr>
        <tr><td>Real-time ticking with RTC</td><td>âœ…</td></tr>
        <tr><td>Detecting clock fault</td><td>âœ…</td></tr>
      </tbody>
    </table>

    <div class="note">
      ğŸ’¡ Tip: Use clean ground reference for oscilloscope and calibrate probe before precise frequency/time measurements.
    </div>
  </div>
</body>
</html>
